!function(e,t){"function"==typeof define&&define.amd?define("./cssdk/common/content",[],t):"object"==typeof exports?module.exports=t():e.Content=t()}(this,function(){var e="",t=5,n={},o=!1;return{HOSTS:{PREPRODUCTION:{host:"betacs.101.com",uc:"https://ucbetapi.101.com/v0.93/"},PRODUCTION:{host:"cs.101.com",uc:"https://aqapi.101.com/v0.93/"},DEBUG:{host:"sdpcs.debug.web.nd",uc:"http://101uccenter.debug.web.nd/v0.93/"},DEV:{host:"sdpcs.dev.web.nd",uc:"https://ucbetapi.101.com/v0.93/"},LOCAL:{host:"localhost:8080",uc:"https://ucbetapi.101.com/v0.93/"},AWS:{host:"awscs.101.com",uc:"https://awsuc.101.com/v0.93/"},AWSUS:{host:"cs-awsca.101.com",uc:"https://awsuc.101.com/v0.93/"}},VERSION:"/v0.1",JSONTYPE:"application/json",PROTOCOL:"http://",HOST_EXPIRES:3600,MAXFILESIZE:"5120M",CALMD5CHUNK:10,RETRYTIMES:3,HOST:"cs.101.com",UCHOST:"https://aqapi.101.com/v0.93/",ENV:"PRODUCTION",THUMB_SIZE:[80,120,160,240,320,480,640,960,1080,1200],TOKENTYPE:{UPLOAD_NORMAL:"UPLOAD_NORMAL",UPLOAD_DIRECT:"UPLOAD_DIRECT",STATUS:"STATUS",QUICK:"QUICK",DOWNLOAD_ID:"DOWNLOAD_ID",DOWNLOAD_PATH:"DOWNLOAD_PATH",DOWNLOAD_STATIC:"DOWNLOAD_STATIC",UPDATE:"UPDATE",LIST_ID:"LIST_ID",LIST_PATH:"LIST_PATH",DELETE_ID:"DELETE_ID",DELETE_PATH:"DELETE_PATH",READ_ID:"READ_ID",READ_PATH:"READ_PATH",VALID:"VALID"},send:function(t,o,r,a){"undefined"==typeof a&&(a=r,r=o,o=null),t.url=this.urlProcess(t.url);var i=this.RETRYTIMES,s={success:function(e,n,o){e=e||{},o.getResponseHeader("ETag")&&(e.etag=o.getResponseHeader("ETag")),e.status>400?(r=null,i-- >=0?$.ajax($.extend(t,s)):a(e)):"function"==typeof r&&r(e)},error:function(e){200===e.status||201===e.status?r(e):e&&e.status<400&&e.status>=500&&i-- >=0?$.ajax($.extend(t,s)):"function"==typeof a&&a(e)},xhr:function(){var t=this,n=$.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(r){"stop"===e&&(t.isAbort=!0,n.abort()),"function"==typeof o&&o(r)},!1),n},async:!0};t=$.extend(t,s),Object.getOwnPropertyNames(n).length>0&&(t=$.extend(n,t)),$.ajax(t)},setUploadStatus:function(t){e=t},getUploadStatus:function(){return e},setChunkSize:function(e){t=parseInt(e),t<1&&(t=1),t>10&&(t=10)},setCancelCallback:function(e){o=e},getCancelCallback:function(){return o},getChunkSize:function(){return t},urlProcess:function(e){var t,n,o=e.split("://");return o.length<=1?(t="http",n=o[0].replace("//","/")):(t=o[0],n=o[1].replace("//","/")),e=(t+"://"+n).replace(/\s+/g,"+").replace(/#/g,"%23"),"PRODUCTION"!==this.ENV&&console.log("request url:"+e),e},setAjaxOption:function(e){"object"==typeof e&&(n=e)},setStorage:function(e,t,n){var o;if("session"===n?window.sessionStorage&&(o=window.sessionStorage):window.localStorage&&(o=window.localStorage),o){"string"!=typeof t&&(t=JSON.stringify(t)),t.replace("%2F","/");try{t?o.setItem(e.trim(),t):o.removeItem(e.trim())}catch(r){o.clear(),o.setItem(e.trim(),t)}}},getStorage:function(e,t){var n;return"session"===t?window.sessionStorage&&(n=window.sessionStorage):window.localStorage&&(n=window.localStorage),n?n.getItem(e.trim()):""},setEnv:function(e){this.HOST=this.HOSTS[e].host,this.UCHOST=this.HOSTS[e].uc,this.ENV=e}}}),function(e,t){"function"==typeof define&&define.amd?define("./cssdk/lib/spark-md5",[],t):"object"==typeof exports?module.exports=t(require()):e.SparkMD5=t()}(this,function(){"use strict";function e(e,t){var n=e[0],o=e[1],r=e[2],a=e[3];n+=(o&r|~o&a)+t[0]-680876936|0,n=(n<<7|n>>>25)+o|0,a+=(n&o|~n&r)+t[1]-389564586|0,a=(a<<12|a>>>20)+n|0,r+=(a&n|~a&o)+t[2]+606105819|0,r=(r<<17|r>>>15)+a|0,o+=(r&a|~r&n)+t[3]-1044525330|0,o=(o<<22|o>>>10)+r|0,n+=(o&r|~o&a)+t[4]-176418897|0,n=(n<<7|n>>>25)+o|0,a+=(n&o|~n&r)+t[5]+1200080426|0,a=(a<<12|a>>>20)+n|0,r+=(a&n|~a&o)+t[6]-1473231341|0,r=(r<<17|r>>>15)+a|0,o+=(r&a|~r&n)+t[7]-45705983|0,o=(o<<22|o>>>10)+r|0,n+=(o&r|~o&a)+t[8]+1770035416|0,n=(n<<7|n>>>25)+o|0,a+=(n&o|~n&r)+t[9]-1958414417|0,a=(a<<12|a>>>20)+n|0,r+=(a&n|~a&o)+t[10]-42063|0,r=(r<<17|r>>>15)+a|0,o+=(r&a|~r&n)+t[11]-1990404162|0,o=(o<<22|o>>>10)+r|0,n+=(o&r|~o&a)+t[12]+1804603682|0,n=(n<<7|n>>>25)+o|0,a+=(n&o|~n&r)+t[13]-40341101|0,a=(a<<12|a>>>20)+n|0,r+=(a&n|~a&o)+t[14]-1502002290|0,r=(r<<17|r>>>15)+a|0,o+=(r&a|~r&n)+t[15]+1236535329|0,o=(o<<22|o>>>10)+r|0,n+=(o&a|r&~a)+t[1]-165796510|0,n=(n<<5|n>>>27)+o|0,a+=(n&r|o&~r)+t[6]-1069501632|0,a=(a<<9|a>>>23)+n|0,r+=(a&o|n&~o)+t[11]+643717713|0,r=(r<<14|r>>>18)+a|0,o+=(r&n|a&~n)+t[0]-373897302|0,o=(o<<20|o>>>12)+r|0,n+=(o&a|r&~a)+t[5]-701558691|0,n=(n<<5|n>>>27)+o|0,a+=(n&r|o&~r)+t[10]+38016083|0,a=(a<<9|a>>>23)+n|0,r+=(a&o|n&~o)+t[15]-660478335|0,r=(r<<14|r>>>18)+a|0,o+=(r&n|a&~n)+t[4]-405537848|0,o=(o<<20|o>>>12)+r|0,n+=(o&a|r&~a)+t[9]+568446438|0,n=(n<<5|n>>>27)+o|0,a+=(n&r|o&~r)+t[14]-1019803690|0,a=(a<<9|a>>>23)+n|0,r+=(a&o|n&~o)+t[3]-187363961|0,r=(r<<14|r>>>18)+a|0,o+=(r&n|a&~n)+t[8]+1163531501|0,o=(o<<20|o>>>12)+r|0,n+=(o&a|r&~a)+t[13]-1444681467|0,n=(n<<5|n>>>27)+o|0,a+=(n&r|o&~r)+t[2]-51403784|0,a=(a<<9|a>>>23)+n|0,r+=(a&o|n&~o)+t[7]+1735328473|0,r=(r<<14|r>>>18)+a|0,o+=(r&n|a&~n)+t[12]-1926607734|0,o=(o<<20|o>>>12)+r|0,n+=(o^r^a)+t[5]-378558|0,n=(n<<4|n>>>28)+o|0,a+=(n^o^r)+t[8]-2022574463|0,a=(a<<11|a>>>21)+n|0,r+=(a^n^o)+t[11]+1839030562|0,r=(r<<16|r>>>16)+a|0,o+=(r^a^n)+t[14]-35309556|0,o=(o<<23|o>>>9)+r|0,n+=(o^r^a)+t[1]-1530992060|0,n=(n<<4|n>>>28)+o|0,a+=(n^o^r)+t[4]+1272893353|0,a=(a<<11|a>>>21)+n|0,r+=(a^n^o)+t[7]-155497632|0,r=(r<<16|r>>>16)+a|0,o+=(r^a^n)+t[10]-1094730640|0,o=(o<<23|o>>>9)+r|0,n+=(o^r^a)+t[13]+681279174|0,n=(n<<4|n>>>28)+o|0,a+=(n^o^r)+t[0]-358537222|0,a=(a<<11|a>>>21)+n|0,r+=(a^n^o)+t[3]-722521979|0,r=(r<<16|r>>>16)+a|0,o+=(r^a^n)+t[6]+76029189|0,o=(o<<23|o>>>9)+r|0,n+=(o^r^a)+t[9]-640364487|0,n=(n<<4|n>>>28)+o|0,a+=(n^o^r)+t[12]-421815835|0,a=(a<<11|a>>>21)+n|0,r+=(a^n^o)+t[15]+530742520|0,r=(r<<16|r>>>16)+a|0,o+=(r^a^n)+t[2]-995338651|0,o=(o<<23|o>>>9)+r|0,n+=(r^(o|~a))+t[0]-198630844|0,n=(n<<6|n>>>26)+o|0,a+=(o^(n|~r))+t[7]+1126891415|0,a=(a<<10|a>>>22)+n|0,r+=(n^(a|~o))+t[14]-1416354905|0,r=(r<<15|r>>>17)+a|0,o+=(a^(r|~n))+t[5]-57434055|0,o=(o<<21|o>>>11)+r|0,n+=(r^(o|~a))+t[12]+1700485571|0,n=(n<<6|n>>>26)+o|0,a+=(o^(n|~r))+t[3]-1894986606|0,a=(a<<10|a>>>22)+n|0,r+=(n^(a|~o))+t[10]-1051523|0,r=(r<<15|r>>>17)+a|0,o+=(a^(r|~n))+t[1]-2054922799|0,o=(o<<21|o>>>11)+r|0,n+=(r^(o|~a))+t[8]+1873313359|0,n=(n<<6|n>>>26)+o|0,a+=(o^(n|~r))+t[15]-30611744|0,a=(a<<10|a>>>22)+n|0,r+=(n^(a|~o))+t[6]-1560198380|0,r=(r<<15|r>>>17)+a|0,o+=(a^(r|~n))+t[13]+1309151649|0,o=(o<<21|o>>>11)+r|0,n+=(r^(o|~a))+t[4]-145523070|0,n=(n<<6|n>>>26)+o|0,a+=(o^(n|~r))+t[11]-1120210379|0,a=(a<<10|a>>>22)+n|0,r+=(n^(a|~o))+t[2]+718787259|0,r=(r<<15|r>>>17)+a|0,o+=(a^(r|~n))+t[9]-343485551|0,o=(o<<21|o>>>11)+r|0,e[0]=n+e[0]|0,e[1]=o+e[1]|0,e[2]=r+e[2]|0,e[3]=a+e[3]|0}function t(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function n(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function o(n){var o,r,a,i,s,u,c=n.length,f=[1732584193,-271733879,-1732584194,271733878];for(o=64;o<=c;o+=64)e(f,t(n.substring(o-64,o)));for(n=n.substring(o-64),r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;o<r;o+=1)a[o>>2]|=n.charCodeAt(o)<<(o%4<<3);if(a[o>>2]|=128<<(o%4<<3),o>55)for(e(f,a),o=0;o<16;o+=1)a[o]=0;return i=8*c,i=i.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(i[2],16),u=parseInt(i[1],16)||0,a[14]=s,a[15]=u,e(f,a),f}function r(t){var o,r,a,i,s,u,c=t.length,f=[1732584193,-271733879,-1732584194,271733878];for(o=64;o<=c;o+=64)e(f,n(t.subarray(o-64,o)));for(t=o-64<c?t.subarray(o-64):new Uint8Array(0),r=t.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;o<r;o+=1)a[o>>2]|=t[o]<<(o%4<<3);if(a[o>>2]|=128<<(o%4<<3),o>55)for(e(f,a),o=0;o<16;o+=1)a[o]=0;return i=8*c,i=i.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(i[2],16),u=parseInt(i[1],16)||0,a[14]=s,a[15]=u,e(f,a),f}function a(e){var t,n="";for(t=0;t<4;t+=1)n+=h[e>>8*t+4&15]+h[e>>8*t&15];return n}function i(e){var t;for(t=0;t<e.length;t+=1)e[t]=a(e[t]);return e.join("")}function s(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function u(e,t){var n,o=e.length,r=new ArrayBuffer(o),a=new Uint8Array(r);for(n=0;n<o;n+=1)a[n]=e.charCodeAt(n);return t?a:r}function c(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function f(e,t,n){var o=new Uint8Array(e.byteLength+t.byteLength);return o.set(new Uint8Array(e)),o.set(new Uint8Array(t),e.byteLength),n?o:o.buffer}function l(e){var t,n=[],o=e.length;for(t=0;t<o-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function d(){this.reset()}var p=function(e,t){return e+t&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==i(o("hello"))&&(p=function(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function e(e,t){return e=0|e||0,e<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(t,n){var o,r,a,i,s=this.byteLength,u=e(t,s),c=s;return void 0!==n&&(c=e(n,s)),u>c?new ArrayBuffer(0):(o=c-u,r=new ArrayBuffer(o),a=new Uint8Array(r),i=new Uint8Array(this,u,o),a.set(i),r)}}(),d.prototype.append=function(e){return this.appendBinary(s(e)),this},d.prototype.appendBinary=function(n){this._buff+=n,this._length+=n.length;var o,r=this._buff.length;for(o=64;o<=r;o+=64)e(this._hash,t(this._buff.substring(o-64,o)));return this._buff=this._buff.substring(o-64),this},d.prototype.end=function(e){var t,n,o=this._buff,r=o.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r;t+=1)a[t>>2]|=o.charCodeAt(t)<<(t%4<<3);return this._finish(a,r),n=i(this._hash),e&&(n=l(n)),this.reset(),n},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},d.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(t,n){var o,r,a,i=n;if(t[i>>2]|=128<<(i%4<<3),i>55)for(e(this._hash,t),i=0;i<16;i+=1)t[i]=0;o=8*this._length,o=o.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(o[2],16),a=parseInt(o[1],16)||0,t[14]=r,t[15]=a,e(this._hash,t)},d.hash=function(e,t){return d.hashBinary(s(e),t)},d.hashBinary=function(e,t){var n=o(e),r=i(n);return t?l(r):r},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(t){var o,r=f(this._buff.buffer,t,!0),a=r.length;for(this._length+=t.byteLength,o=64;o<=a;o+=64)e(this._hash,n(r.subarray(o-64,o)));return this._buff=o-64<a?new Uint8Array(r.buffer.slice(o-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(e){var t,n,o=this._buff,r=o.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r;t+=1)a[t>>2]|=o[t]<<(t%4<<3);return this._finish(a,r),n=i(this._hash),e&&(n=l(n)),this.reset(),n},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var e=d.prototype.getState.call(this);return e.buff=c(e.buff),e},d.ArrayBuffer.prototype.setState=function(e){return e.buff=u(e.buff,!0),d.prototype.setState.call(this,e)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(e,t){var n=r(new Uint8Array(e)),o=i(n);return t?l(o):o},d}),function(e,t){"function"==typeof define&&define.amd?define("./cssdk/common/httpclient",["../common/content"],t):"object"==typeof exports?module.exports=t(require("../common/content")):e.CSHttpClient=t(e.Content)}(this,function(e){return{doGetRequest:function(t,n,o){e.send({url:t,type:"GET",dataType:"json"},n,o)},doPostRequest:function(t,n,o,r,a){"function"==typeof o&&(a=r,r=o,o={});var i=o.dataType||"json",s=o.contentType||e.JSONTYPE;delete o.contentType,delete o.dataType,e.send({url:t,type:"POST",dataType:i,headers:o,contentType:s,data:n},r,a)},doUploadRequest:function(t,n,o,r,a,i,s){var u=o.contentType||!1;delete o.contentType;var c=r instanceof Blob?"xml":"json";e.send({url:t,type:n,headers:o,contentType:u,dataType:c,processData:!1,data:r},a,i,s)},doPutRequest:function(t,n,o,r,a){"function"==typeof o&&(a=r,r=o,o={}),e.send({url:t,type:"PUT",data:n,dataType:"json",contentType:e.JSONTYPE,headers:o,processData:!1},r,a)},doDeleteRequest:function(t,n,o,r){"function"==typeof n&&(r=o,o=n,n={}),e.send({url:t,type:"DELETE",dataType:"json",headers:n,contentType:e.JSONTYPE},o,r)},doPatchRequest:function(t,n,o,r,a){"function"==typeof o&&(a=r,r=o,o={}),e.send({url:t,type:"PATCH",dataType:"json",headers:o,contentType:e.JSONTYPE,data:n},r,a)}}}),function(e,t){"function"==typeof define&&define.amd?define("./cssdk/common/utils",["../lib/spark-md5","../common/content"],t):"object"==typeof exports?module.exports=t(require("../lib/spark-md5"),require("../common/content")):e.CSUtils=t(e.SparkMD5,e.Content)}(this,function(e,t){var n=!1,o=[],r={};return r.params=[],r.addParam=function(e,t,n){return r.params.push({rule:e,name:t,value:n}),this},{params:r,deepCopy:function(e){var t={};for(var n in e)t[n]="object"==typeof e[n]?this.deepCopy(e[n]):e[n];return t},objToFormdata:function(e){var t=new FormData;for(var n in e)"function"==typeof e[n]?e[n]():t.append(n,e[n]);return t},randomString:function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,o="",r=0;r<e;r++)o+=t.charAt(Math.floor(Math.random()*n));return o},hashCode:function(e){var t=e.name+e.size+e.type+e.lastModifiedDate,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split(""),o=5381,r=t.length-1;if("string"==typeof t)for(;r>-1;r--)o+=(o<<5)+t.charCodeAt(r);else for(;r>-1;r--)o+=(o<<5)+t[r];var a=2147483647&o,i="";do i+=n[63&a];while(a>>=6);return i},calMd5:function(n,o,r,a){function i(){var e=new FileReader;e.onload=p,e.onerror=h;var t=l*c,o=t+c>=n.size?n.size:t+c;e.readAsArrayBuffer(u.call(n,t,o))}var s={file_hash:n.hash,total:n.size},u=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,c=1024*t.CALMD5CHUNK*1024,f=Math.ceil(n.size/c),l=0,d=new e.ArrayBuffer,p=function(e){if(d.append(e.target.result),l++,l<f){if(s.loaded=l*c*.1,"stop"===t.getUploadStatus())return void a("upload cancelled");"function"==typeof o&&o(s),i()}else r(d.end())},h=function(){throw new Error("\noops, something went wrong.")};i()},isNum:function(e){if("number"==typeof e)return!0;var t=new RegExp("^[0-9]+$");return t.test(e)},isEmpty:function(e){return!("string"==typeof e&&""!==e)},isObject:function(e){return null!==e&&"object"==typeof e},isBlank:function(e){return!("string"==typeof e&&""!==e.trim())},isNotBlank:function(e){return"string"==typeof e&&""!==e.trim()},isRangeNum:function(e,t,n){return!!(isNum(e)&&e>=t&&e<=n)},isRange:function(e,t,n){if("string"!=typeof e)return!1;var o=e.length;return!(t!=-1&&o<t)&&!(n!=-1&&o>n)},isLess:function(e,t){return this.isRange(e,t,-1)},isMore:function(e,t){return this.isRange(e,-1,t)},isMd5:function(e){var t=new RegExp("[0-9a-zA-Z]{32}");return t.test(e)},isName:function(e){var t=new RegExp('^[^\\\\/:*?"<>|]+$');return t.test(e)},isDash:function(e){var t=new RegExp("^[\\w]+$");return t.test(e)},isPath:function(e){var t=new RegExp('^/|(/[^\\\\:*?"<>|]+)+$');return t.test(e)},isUuid:function(e){var t=new RegExp("[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}");return t.test(e)},isPassword:function(e){var t=new RegExp("^[a-zA-Z0-9]{6,16}$");return t.test(e)},isNull:function(e){return null===e},addResult:function(e){n=!0,o.push(e)},valid:function(e){for(var t in e)switch(t.rule){case"string":this.isBlank(t.value)&&this.addResult(t.name+" Must be a non empty string");break;case"num":this.isNum(t.value)||this.addResult(t.name+" value:"+t.value+" Must be numeric");break;case"password":this.isPassword(t.value)||this.addResult(t.name+" value:"+t.value+" Must be composed of numbers and letters for 6-16 bits");break;case"uuid":this.isUuid(t.value)||this.addResult(t.name+" value:"+t.value+" Must be UUID");break;case"path":this.isPath(t.value)||this.addResult(t.name+" Must be path format");break;case"null":this.isNull(t.value)&&this.addResult(t.name+" As required")}if(n)throw new Error("params error:"+o)}}}),function(e,t){"function"==typeof define&&define.amd?define("./cssdk/common/uploader",["../common/httpclient","../common/content","../common/utils"],t):"object"==typeof exports?module.exports=t(require("../common/httpclient"),require("../common/content"),require("../common/utils")):e.CSUploader=t(e.CSHttpClient,e.Content,e.CSUtils)}(this,function(e,t,n){var o=function(e,n,o,r){if(o){var a,i;e.path&&e.name?a=e.path+"/"+e.name:i=e.dentryId,o.getToken(t.TOKENTYPE.UPLOAD_NORMAL,a,i,null,function(e){if(e.token){var n=t.HOST+t.VERSION+"/upload?token="+e.token+"&policy="+e.policy+"&date="+encodeURIComponent(e.date_time);r(n)}else r(e)})}else n.getSession(function(n){var o=t.HOST+t.VERSION+"/upload?serviceName="+e.serviceName+"&session="+n;r(o)})},r=function(n,o,r,a,i,s,u,c){var f="name="+r+"&chunks="+a;if(f+=o?"&path="+encodeURIComponent(o):"&parentId="+n,s){var l=t.VERSION+"/upload/actions/status?"+f;s.getToken(t.TOKENTYPE.STATUS,o,n,f,function(n){if(n.token){var o=t.HOST+l+"&token="+n.token+"&policy="+n.policy+"&date="+encodeURIComponent(n.date_time);e.doGetRequest(o,u,c)}else c(n)})}else i.getSession(function(n){var o=t.HOST+t.VERSION+"/upload/actions/status?"+f+"&session="+n;e.doGetRequest(o,u,c)})},a=function(r,a,i,s,u,c,f){var l=1024*t.getChunkSize()*1024,d=r.chunk,p=r.chunks;r.size=a.size;var h={file_hash:a.hash,loaded:d*l,total:a.size};u(h);var m=function(d){var h,y=d*l,v=d<p-1?y+l:a.size;h=r.path&&r.name?r.path+"_"+r.name+"_"+a.hash+"_"+p:r.dentryId+"_"+a.hash+"_"+p,function(d,y,v){r.chunk=d,r.pos=d*l;var g=n.objToFormdata(r);g.append("file",a.source.slice(y,v));var S=function(e){d<p-1?(t.setStorage(h,String(d)),m(++d)):(t.setStorage(h,""),c(e))},T=function(e){d>=1&&t.setStorage(h,d-1),f(e)},w=function(e){var t=n.deepCopy(e);t.loaded=d*l+t.loaded,t.total=a.size,u(t)};o(r,i,s,function(t){"object"==typeof t?f(t):e.doUploadRequest(t,"POST",{},g,w,S,T)})}(d,y,v)};m(d)};return{upload:function(i,s,u,c,f,l,d){if(!i)throw new Error("Please select file！");"function"==typeof i.getNative?i.source=i.getNative():i.source=i,s.path=i.path||s.path;var p=1024*t.getChunkSize()*1024;if(i.size<=p){var h={file_hash:i.hash,loaded:0,total:i.size};f(h);var m=n.objToFormdata(s);m.append("file",i.source),o(s,c,u,function(t){e.doUploadRequest(t,"POST",{},m,f,l,d)})}else{var y=Math.ceil(i.size/p);s.chunks=y;var v;v=s.path&&s.name?s.path+"_"+s.name+"_"+i.hash+"_"+y:s.dentryId+"_"+i.hash+"_"+y;var g=t.getStorage(v);g?(s.chunk=g,a(s,i,c,u,f,l,d)):s.parentId||s.path?r(s.parentId,s.path,s.name,y,c,u,function(e){s.chunk=Object.getOwnPropertyNames(e).length-1,a(s,i,c,u,f,l,d)},function(){s.chunk=0,a(s,i,c,u,f,l,d)}):(s.chunk=0,a(s,i,c,u,f,l,d))}}}}),function(e,t){"function"==typeof define&&define.amd?define("./cssdk/third-platform-sdk/ceph-s3-sdk",["../common/content","../common/httpclient"],t):"object"==typeof exports?module.exports=t(require("../common/content"),require("../common/httpclient")):e.CephS3=t(e.Content,e.CSHttpClient)}(this,function(e,t){return{putObject:function(e,n,o,r,a){var i=n.upload_url,s={},u=e.type;u||(u="application/octet-stream"),s.contentType=u,s.Authorization=n.upload_token,n.nds_cb_url&&(s["nds-cb-url"]=n.nds_cb_url),s["x-amz-date"]=n.upload_date,t.doUploadRequest(i,"PUT",s,e,o,r,a)},getTokenParams:function(e){e=parseInt(e);var t={};switch(t.xAmzDate="1",e){case 2:t.uploadId=1,t.objectName=1,t.chunkNum=1;break;case 3:t.uploadId=1,t.objectName=1}return t},initiateMultipartUpload:function(e,n){var o=e.upload_url,r={};r.Authorization=e.upload_token,r["x-amz-date"]=e.upload_date,r.contentType=e.contentType,r.dataType="xml";var a={};t.doPostRequest(o,a,r,function(e){n(e.documentElement.childNodes)},function(e){throw new Error("initiateMultipartUpload failed! "+JSON.stringify(e))})},multipartUploadPartByStream:function(n,o,r,a,i){var s=n.upload_url,u={};u.Authorization=n.upload_token,u["x-amz-date"]=n.upload_date,u.contentType=e.JSONTYPE,t.doUploadRequest(s,"PUT",u,r,a,function(e){i(e.etag)},function(e){i(e.etag)})},completeMultipartUpload:function(n,o,r,a){var i=n.upload_url,s={};s.Authorization=n.upload_token,s["x-amz-date"]=n.upload_date,n.nds_cb_url&&(s["nds-cb-url"]=n.nds_cb_url),s.contentType=e.JSONTYPE,s.dataType="xml";for(var u='<?xml version="1.0"?><CompleteMultipartUpload>',c=1;c<=r.length;c++)u+="<Part><PartNumber>"+c+"</PartNumber><ETag>"+r[c-1]+"</ETag></Part>";u+="</CompleteMultipartUpload>",t.doPostRequest(i,u,s,a,function(e){a(e)},function(e){throw new Error("completeMultipartUpload failed ! "+JSON.stringify(e))})}}}),function(e,t){"function"==typeof define&&define.amd?define("./cssdk/third-platform-adapter/ceph-s3-adapter",["../third-platform-sdk/ceph-s3-sdk","../common/httpclient","../common/content","../common/utils"],t):"object"==typeof exports?module.exports=t(require("../third-platform-sdk/ceph-s3-sdk"),require("../common/httpclient"),require("../common/content"),require("../common/utils")):e.CephS3Adapter=t(e.CephS3,e.CSHttpClient,e.Content,e.CSUtils)}(this,function(e,t,n,o){var r=function(e,t){var n;return n=t.path&&t.name?t.path+"_"+t.name+"_"+e.hash:t.dentryId+"_"+e.hash},a=function(e,r,a,i,s,u){if(o.isBlank(e)&&o.isBlank(r))throw new Error("dentryId or path must select one");var c="";c+=e?"dentryId="+e:"path="+r,a?a.getToken(n.TOKENTYPE.VALID,r,e,c,function(e){if(e.token){c=encodeURIComponent(c).replace(/%2F/g,"/").replace(/%3D/g,"=");var o=n.HOST+n.VERSION+"/dentries/actions/valid?"+c+"&token="+e.token+"&policy="+e.policy+"&date="+encodeURIComponent(e.date_time);t.doPutRequest(o,JSON.stringify({}),s,u)}else u(e)}):i.getSession(function(e){c=encodeURIComponent(c).replace(/%2F/g,"/").replace(/%3D/g,"=");var o=n.HOST+n.VERSION+"/dentries/actions/valid?"+c+"&session="+e;t.doPutRequest(o,JSON.stringify({}),s,u)})},i=function(e,r,a,i,s,u,c,f){f||(f=c,c=u,u=null);var l=function(e,n,r,a){r.tokenParams=JSON.stringify(n),e&&e.path&&(r.path=e.path);var i=o.objToFormdata(r);t.doUploadRequest(a,"POST",{},i,null,function(e){if(r={},2===e.type&&e.valid!==-1)delete e.upload_params,c(e);else{var t=e.upload_params;t.path=e.path,c(t)}},function(e){f("Get uploadParameter falied!"+JSON.stringify(e))})},d=function(e,t,r,a){e?(t.contentType=e.type,t.contentType||(t.contentType="application/octet-stream"),o.calMd5(e.source,u,function(n){r.md5=n,r.size=e.size||0,l(e,t,r,a)},f)):(t.contentType=n.JSONTYPE,l(e,t,r,a))};if(i){var p,h;r.path&&r.name?p=r.path+"/"+r.name:h=r.dentryId,i.getToken(n.TOKENTYPE.UPLOAD_DIRECT,p,h,null,function(t){if(t.token){var o=n.HOST+n.VERSION+"/upload/actions/direct?token="+t.token+"&policy="+t.policy+"&date="+encodeURIComponent(t.date_time);d(e,a,r,o)}else f(t)})}else s.getSession(function(t){var o=n.HOST+n.VERSION+"/upload/actions/direct?serviceName="+r.serviceName+"&session="+t;d(e,a,r,o)})},s=function(e,t){for(var n=0;n<e.length;n++)if(e[n].nodeName===t)return e[n].textContent;return""},u=function(t,n,o,r,a,u,c){var f=e.getTokenParams(1);!function(t,n,f){n.chunkType=1,i(t,n,f,o,r,a,function(t){t.dentry_id?u(t):(t.contentType=f.contentType,e.initiateMultipartUpload(t,function(e){var n={};n.UploadId=s(e,"UploadId"),n.objectName=s(e,"Key"),n.path=t.path,u(n)},c))},c)}(t,n,f)},c=function(t,o,a,s,u,c,f,l,d,p){u||(u=[]);var h=1024*n.getChunkSize()*1024,m=Math.ceil(a.size/h),y=[];if(u&&u.length>0){if(u.length===m)return void d(u);for(var v=0;v<m;v++)u[v]||y.push(v+1)}else for(var g=1;g<=m;g++)y.push(g);var S=0,T=1;a.size>1024*n.CALMD5CHUNK*1024&&(S=.1*a.size,T=.9);var w={file_hash:a.hash,loaded:u.length*h*T+S,total:a.size};l(w);var E={};E.UploadId=t,E.objectName=o,E.etags=u,E.fullPath=s.fullPath;var N=0,b=function(v){var g=y[v],N=(g-1)*h,O=a.size;g!==m&&(O=N+h),function(y,g,N){var O=e.getTokenParams(2);O.uploadId=t,O.objectName=o,O.chunkNum=y,s.chunkType=2,i(null,s,O,c,f,function(o){var i=a.source.slice(g,N);e.multipartUploadPartByStream(o,t,i,function(e){w={file_hash:a.hash,loaded:(u.length*h+e.loaded)*T+S,total:a.size},l(w)},function(e){return e?(e=e.substring(1,e.length-1),u[y-1]=e,n.setStorage(r(a,s),JSON.stringify(E)),void(u.length<m?b(++v):d(u))):void p("upload part falid ! uploadId="+t+" partNumber="+v)})},p)}(g,N,O)};b(N)},f=function(t,n,o,r,a,s,u,c){var f=e.getTokenParams(3);o.chunkType=3,f.uploadId=t,f.objectName=n,i(null,o,f,a,s,function(n){e.completeMultipartUpload(n,t,r,u)},c)},l=function(e,t,n,o,r,i,s){a(null,e,t,n,function(e){o(e);var t={loaded:i.size,total:i.size};s(t)},function(e){r("update dentry valid failed!"+JSON.stringify(e))})},d=function(e,t,o,a,i,s,p,h){var m=n.RETRYTIMES,y=function(u){var y=u.UploadId,v=u.objectName,g=u.fullPath;t.fullPath=g,c(y,v,e,t,u.etags,a,i,s,function(u){for(var c=0;c<u.length;c++)u[c]||(m-- >=0?d(e,t,o):h("multipartUpload file failed!"));f(y,v,t,u,a,i,function(){n.setStorage(r(e,t),""),l(g,a,i,p,h,e,s)},h)},h)};if(o){var v=JSON.parse(o);y(v)}else u(e,t,a,i,s,function(t){if(t.dentry_id){p(t);var n={loaded:e.size,total:e.size};s(n)}else t.fullPath=t.path,y(t)},h)};return{upload:function(t,o,a,s,u,c,f){if(!t)throw new Error("Please select files！");if("function"==typeof t.getNative?t.source=t.getNative():t.source=t,t.size<=1024*n.getChunkSize()*1024){var p={file_hash:t.hash,loaded:0,total:t.size};u(p);var h=e.getTokenParams(0);i(t,o,h,a,s,function(n){if(2===n.type&&n.valid!==-1){delete n.upload_params;var o={loaded:t.size,total:t.size};u(o),u(o),c(n)}else e.putObject(t.source,n,function(e){e.loaded-=1,u(e)},function(){l(n.path,a,s,c,f,t,u)},f)},f)}else{var m=n.getStorage(r(t,o));d(t,o,m,a,s,u,c,f)}}}}),function(e,t){var n="../common/httpclient",o="../third-platform-adapter/ceph-s3-adapter",r="../common/utils",a="../common/content",i="../common/uploader";"function"==typeof define&&define.amd?define("./cssdk/api/cs-object",[n,o,r,a,i],t):"object"==typeof exports?module.exports=t(require(n),require(o),require(r),require(a),require(i)):e.CSClient=t(e.CSHttpClient,e.CephS3Adapter,e.CSUtils,e.Content,e.CSUploader)}(this,function(e,t,n,o,r){var a={WAITING:"waiting",UPLOADING:"uploading"},i=[],s=a.WAITING,u=function(e){i.push(e);var t=function(){i.splice(0,1),i.length>0?n(i[0]):s=a.WAITING},n=function(e){!function(e){var n=e.file,r=e.uploadData,a=e.listenner,i=e.token,u=e.session;o.uploadingFile=n,s="uploading",o.setUploadStatus(""),l(n,r,a.onNotifyProgress,function(e){a.onNotifySuccess(e),t()},function(e){("stop"!==o.getUploadStatus()||o.getCancelCallback())&&a.onNotifyFail(e),t(e)},i,u)}(e)};s===a.WAITING&&n(i[0])},c=function(e){var n;switch(e){case"s3":n=t;break;case"aws":break;case"aliyun":break;case"cs":n=r;break;default:throw new Error("platform invalid")}return n},f=function(t,n){if(!t)return void n({});var r=o.getStorage(o.ENV+"_"+t,"session");if(r)n(JSON.parse(r));else{var a=o.HOST+o.VERSION+"/services/serviceName/"+t;e.doGetRequest(a,function(e){var r={};r.platform=e.platform;var a=86400;if(e.strategies){var i=e.strategies.direct;i&&(r.strategies={},r.strategies.direct=i,a=i.expires)}o.setStorage(o.ENV+"_"+t,JSON.stringify(r),"session"),n(e)},function(){n({})})}},l=function(e,t,n,o,r,a,i){if(!e)throw new Error("please select file!");if(!i&&!a)throw new Error("token or session must select one");f(t.serviceName,function(s){var u="cs";if(s.strategies){var f=s.strategies.direct;f&&f.uploadDirect&&"1"===f.uploadDirect.toString()&&(u=s.platform)}var l=c(u);l.upload(e,t,a,i,function(t){t.file_hash=e.hash,n(t)},o,r)})};return{tryQuickUploadByMd5:function(t,r,a,i,s,u,c,f){if(!t)throw new Error("require serviceName");if(!n.isPath(a))throw new Error("remoteDstPath is invalid");var l={};l.md5=r;var d=a.lastIndexOf("/");l.path=a.substring(0,d),l.name=a.substring(d+1,a.length),l.scope=i,s?s.getToken(o.TOKENTYPE.QUICK,a,null,null,function(t){if(t.token){var n=o.HOST+o.VERSION+"/dentries/actions/quick?token="+t.token+"&policy="+t.policy+"&date="+encodeURIComponent(t.date_time);e.doPostRequest(n,JSON.stringify(l),c,f)}else f(t)}):u.getSession(function(n){var r=o.HOST+o.VERSION+"/dentries/actions/quick?serviceName="+t+"&session="+n;e.doPostRequest(r,JSON.stringify(l),c,f)})},upload:function(e,t,o,r,a,i,s){if(!e)throw new Error("require serviceName");if(!o)throw new Error("require remotePath");if(!n.isPath(o))throw new Error(" remotePath is invalid");if("object"!=typeof a)throw new Error("require listenner");if("function"!=typeof a.onNotifySuccess)throw new Error("require success callback");if("function"!=typeof a.onNotifyFail)throw new Error("require failure callback");if("function"!=typeof a.onNotifyProgress)throw new Error("require progress callback");var c={},f=o.lastIndexOf("/");if(c.path=o.substring(0,f),c.name=o.substring(f+1,o.length),c.scope=r,c.serviceName=e,!n.isName(c.name))throw new Error("name is invalid!");t.hash||(t.hash=n.hashCode(t));var l={file:t,uploadData:c,listenner:a,token:i,session:s};u(l)},uploadCover:function(e,t,o,r,a,i,s){if(!e)throw new Error("require serviceName");if(!o)throw new Error("require dentryId");if(!n.isUuid(o))throw new Error(" dentryId is invalid");if("object"!=typeof a)throw new Error("require listenner");if("function"!=typeof a.onNotifySuccess)throw new Error("require success callback");if("function"!=typeof a.onNotifyFail)throw new Error("require failure callback");if("function"!=typeof a.onNotifyProgress)throw new Error("require progress callback");var c={};c.dentryId=o,c.scope=r,c.serviceName=e,t.hash||(t.hash=n.hashCode(t));var f={file:t,uploadData:c,listenner:a,token:i,session:s};u(f)},downloadByPath:function(e,t,r,a,i,s,u){if("undefined"==typeof u&&(u=s,s=i,i=null),"undefined"==typeof s&&(u=i,s=a,a=!1,i=null),!e)throw new Error("require serviceName");if(!t)throw new Error("require remotePath");if(!n.isPath(t))throw new Error("remotePath is invalid");if(r&&o.THUMB_SIZE.indexOf(parseInt(r))===-1)throw new Error("size is invalid");var c="serviceName="+e;r&&(c+="&size="+r);var f=c;if(a&&"true"===a&&(c+="&attachment="+a,f=c,i&&(f+="&name="+encodeURIComponent(i),c+="&name="+i)),s)s.getToken(o.TOKENTYPE.DOWNLOAD_PATH,t,null,c,function(e){if(!e.token)throw new Error("get token error");var n=o.HOST+o.VERSION+"/download/actions/direct?path="+encodeURIComponent(t)+"&"+f+"&token="+e.token+"&policy="+e.policy+"&expireAt="+e.expire_at;window.open(o.urlProcess(n))});else if(u)u.getSession(function(e){var n=o.HOST+o.VERSION+"/download/actions/direct?path="+encodeURIComponent(t)+"&"+c+"&session="+e;window.open(o.urlProcess(n))});else{var l=o.HOST+o.VERSION+"/download/actions/direct?path="+encodeURIComponent(t)+"&"+c;window.open(o.urlProcess(l))}},getDownloadUrlByDentryId:function(e,t,r,a,i,s,u,c){"function"==typeof u&&(c=u,u=s,s=i,i=null),"function"==typeof s&&(c=s,u=i,s=a,a=!1,i=null);var f={};if(!e)return f.status="failed",f.error="require serviceName",void c(f);if(!t||!n.isUuid(t))return f.status="failed",f.error="dentryId is invalid",void c(f);if(r&&o.THUMB_SIZE.indexOf(parseInt(r))===-1)return f.status="failed",f.error="size is invalid",void c(f);var l="serviceName="+e;r&&(l+="&size="+r);var d=l;if(a&&"true"===a&&(l+="&attachment="+a,d=l,i&&(d+="&name="+encodeURIComponent(i),l+="&name="+i)),s)s.getToken(o.TOKENTYPE.DOWNLOAD_ID,null,t,l,function(e){if(e.token){var n=o.HOST+o.VERSION+"/download/actions/direct?dentryId="+t+"&"+d+"&token="+e.token+"&policy="+e.policy+"&expireAt="+e.expire_at;f.status="succeed",f.url=o.urlProcess(n)}else f.status="failed",f.error="get token error";c(f)});else if(u)u.getSession(function(e){var n=o.HOST+o.VERSION+"/download/actions/direct?dentryId="+t+"&session="+e+"&"+l;f.status="succeed",f.url=o.urlProcess(n),c(f)});else{var p=o.HOST+o.VERSION+"/download/actions/direct?dentryId="+t+"&"+l;f.status="succeed",f.url=o.urlProcess(p),c(f)}},downloadById:function(e,t,n,r,a,i,s){if(!e)throw new Error("require serviceName");this.getDownloadUrlByDentryId(e,t,n,r,a,i,s,function(e){
window.open(o.urlProcess(e.url))})},stop:function(e){if(e&&i&&!(i.length<=0)){var t=e.hash;if(t||(t=n.hashCode(e)),o.uploadingFile&&t===o.uploadingFile.hash)return void o.setUploadStatus("stop");for(var r=0;r<i.length;r++)if(i[r].file.hash==t){i.splice(r,1);break}}}}});